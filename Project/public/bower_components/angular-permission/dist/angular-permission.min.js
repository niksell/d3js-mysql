/**
 * angular-permission
 * Fully featured role and permission based access control for your angular applications
 * @version v3.2.1 - 2016-07-07
 * @link https://github.com/Narzerus/angular-permission
 * @author Rafael Vidaurre <narzerus@gmail.com> (http://www.rafaelvidaurre.com), Blazej Krysiak <blazej.krysiak@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */


!function(a,angular,b){"use strict";function c(a){"ngInject";function b(b){var c=a.defer(),d=0,e=angular.isArray(b)?[]:{};return angular.forEach(b,function(b,f){d++,a.when(b).then(function(a){c.resolve(a)})["catch"](function(a){e[f]=a,--d||c.reject(a)})}),0===d&&c.reject(e),c.promise}return a.any=b,a}function d(){"ngInject";this.broadcastPermissionStartEvent=function(){throw new Error("Method broadcastPermissionStartEvent in TransitionEvents interface must be implemented")},this.broadcastPermissionAcceptedEvent=function(){throw new Error("Method broadcastPermissionAcceptedEvent in TransitionEvents interface must be implemented")},this.broadcastPermissionDeniedEvent=function(){throw new Error("Method broadcastPermissionDeniedEvent in TransitionEvents interface must be implemented")}}function e(a,b){"ngInject";function c(a,b){e(a,b),this.permissionName=a,this.validationFunction=b}function d(b,c){var d=a.defer();return b?d.resolve(c):d.reject(c),d.promise}function e(a,b){if(!angular.isString(a))throw new TypeError('Parameter "permissionName" name must be String');if(!angular.isFunction(b))throw new TypeError('Parameter "validationFunction" must be Function')}return c.prototype.validatePermission=function(){var a=this.validationFunction.call(null,this.permissionName,b);return angular.isFunction(a.then)||(a=d(a,this.permissionName)),a},c}function f(a,b,c){"ngInject";function d(a,b){f(a,b),this.roleName=a,this.validationFunction=b}function e(b,c){var d=a.defer();return b?d.resolve(c):d.reject(c),d.promise}function f(a,b){if(!angular.isString(a))throw new TypeError('Parameter "roleName" name must be String');if(!angular.isArray(b)&&!angular.isFunction(b))throw new TypeError('Parameter "validationFunction" must be array or function')}return d.prototype.validateRole=function(){if(angular.isFunction(this.validationFunction)){var d=this.validationFunction.call(null,this.roleName,c);return angular.isFunction(d.then)||(d=e(d,this.roleName)),d}if(angular.isArray(this.validationFunction)){var f=this.validationFunction.map(function(c){if(b.hasPermissionDefinition(c)){var d=b.getPermissionDefinition(c);return d.validatePermission()}return a.reject(c)});return a.all(f)}},d}function g(a){"ngInject";function b(b,c){var d=new a(b,c);i[b]=d}function c(a,c){if(!angular.isArray(a))throw new TypeError('Parameter "permissionNames" name must be Array');angular.forEach(a,function(a){b(a,c)})}function d(a){delete i[a]}function e(a){return angular.isDefined(i[a])}function f(a){return i[a]}function g(){return i}function h(){i={}}var i={};this.definePermission=b,this.defineManyPermissions=c,this.removePermissionDefinition=d,this.hasPermissionDefinition=e,this.getPermissionDefinition=f,this.getStore=g,this.clearStore=h}function h(a){"ngInject";function b(b,c){i[b]=new a(b,c)}function c(a){if(!angular.isObject(a))throw new TypeError('Parameter "roleNames" name must be object');angular.forEach(a,function(a,c){b(c,a)})}function d(a){delete i[a]}function e(a){return angular.isDefined(i[a])}function f(a){return i[a]}function g(){return i}function h(){i={}}var i={};this.defineRole=b,this.defineManyRoles=c,this.getRoleDefinition=f,this.hasRoleDefinition=e,this.removeRoleDefinition=d,this.getStore=g,this.clearStore=h}function i(a,b,c,d,e){"ngInject";return{restrict:"A",bindToController:{sref:"=?permissionSref",only:"=?permissionOnly",except:"=?permissionExcept",onAuthorized:"&?permissionOnAuthorized",onUnauthorized:"&?permissionOnUnauthorized"},controllerAs:"permission",controller:["$scope","$element",function(f,g){function h(){return b.has("$state")&&k.sref}function i(){angular.isFunction(k.onAuthorized)?k.onAuthorized()(g):e.showElement(g)}function j(){angular.isFunction(k.onUnauthorized)?k.onUnauthorized()(g):e.hideElement(g)}var k=this;f.$watchGroup(["permission.only","permission.except","sref"],function(){try{var e;if(h()){var f=b.get("$state"),g=f.get(k.sref);e=new d(g.data.permissions)}else e=new d({only:k.only,except:k.except});c.authorize(e).then(function(){i()})["catch"](function(){j()})}catch(l){j(),a.error(l.message)}})}]}}function j(a){"ngInject";function b(a){return c(a)}function c(b){var c=a.defer();return d(c,b),c.promise}function d(b,c){var d=c.resolvePropertyValidity(c.except);a.any(d).then(function(a){b.reject(a)})["catch"](function(){e(b,c)})}function e(b,c){if(!c.only.length)return void b.resolve();var d=c.resolvePropertyValidity(c.only);a.any(d).then(function(a){b.resolve(a)})["catch"](function(a){b.reject(a)})}this.authorize=b}function k(a,b,c,d){"ngInject";function e(a){a=a||{},this.only=h(a.only),this.except=h(a.except),this.redirectTo=a.redirectTo}function f(c,d){return a.when(c.call(null,d,b)).then(function(b){return angular.isString(b)?{state:b}:angular.isObject(b)?b:a.reject()})}function g(b,c){if(!angular.isDefined(b["default"]))throw new ReferenceError('When used "redirectTo" as object, property "default" must be defined');var d=b[c];return angular.isDefined(d)||(d=b["default"]),angular.isFunction(d)?f(d,c):angular.isObject(d)?a.resolve(d):angular.isString(d)?a.resolve({state:d}):void 0}function h(a){return angular.isString(a)?[a]:angular.isArray(a)?a:angular.isFunction(a)?a.call(null,b):[]}return e.prototype.resolveRedirectState=function(b){return angular.isFunction(this.redirectTo)?f(this.redirectTo,b):angular.isObject(this.redirectTo)?g(this.redirectTo,b):angular.isString(this.redirectTo)?a.resolve({state:this.redirectTo}):a.reject()},e.prototype.resolvePropertyValidity=function(b){return b.map(function(b){if(c.hasRoleDefinition(b)){var e=c.getRoleDefinition(b);return e.validateRole()}if(d.hasPermissionDefinition(b)){var f=d.getPermissionDefinition(b);return f.validatePermission()}return a.reject(b)})},e}c.$inject=["$delegate"],e.$inject=["$q","TransitionProperties"],f.$inject=["$q","PermissionStore","TransitionProperties"],g.$inject=["Permission"],h.$inject=["Role"],i.$inject=["$log","$injector","Authorization","PermissionMap","PermissionStrategies"],j.$inject=["$q"],k.$inject=["$q","TransitionProperties","RoleStore","PermissionStore"];var l=angular.module("permission",[]);"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports=l.name),angular.module("permission").decorator("$q",c);var m={enableElement:function(a){a.removeAttr("disabled")},disableElement:function(a){a.attr("disabled","disabled")},showElement:function(a){a.removeClass("ng-hide")},hideElement:function(a){a.addClass("ng-hide")}};angular.module("permission").value("PermissionStrategies",m);var n={};angular.module("permission").value("TransitionProperties",n),angular.module("permission").service("TransitionEvents",d),angular.module("permission").factory("Permission",e),angular.module("permission").factory("Role",f),angular.module("permission").service("PermissionStore",g),angular.module("permission").service("RoleStore",h),angular.module("permission").directive("permission",i),angular.module("permission").service("Authorization",j),angular.module("permission").factory("PermissionMap",k)}(window,window.angular);
//# sourceMappingURL=angular-permission.min.js.map