!function(){"use strict";angular.module("multiselect-searchtree",[])}(),function(){"use strict";var e=angular.module("multiselect-searchtree");e.controller("multiSelectTreeCtrl",["$scope","$document",function(e,t){function l(){c(),e.$apply()}function c(){e.showTree=!1,r&&(r.isActive=!1,r=void 0),t.off("click",l)}function n(t){for(var l=0,c=t.length;c>l;l++)i(t[l])||t[l].selected!==!0?i(t[l])&&t[l].selected===!1&&(t[l].selected=!0):e.selectedItems.push(t[l]),t[l]&&t[l].children&&n(t[l].children)}function i(t){var l=!1;if(e.selectedItems)for(var c=0;c<e.selectedItems.length;c++)if(e.selectedItems[c].id===t.id){l=!0;break}return l}var r;e.showTree=!1,e.selectedItems=[],e.multiSelect=e.multiSelect||!1,e.onActiveItem=function(e){r!==e&&(r&&(r.isActive=!1),r=e,r.isActive=!0)},e.refreshOutputModel=function(){e.outputModel=angular.copy(e.selectedItems)},e.refreshSelectedItems=function(){e.selectedItems=[],e.inputModel&&n(e.inputModel)},e.deselectItem=function(t,l){l.stopPropagation(),e.selectedItems.splice(e.selectedItems.indexOf(t),1),t.selected=!1,this.refreshOutputModel()},e.onControlClicked=function(c){c.stopPropagation(),e.showTree=!e.showTree,e.showTree&&t.on("click",l)},e.onFilterClicked=function(e){e.stopPropagation()},e.clearFilter=function(t){t.stopPropagation(),e.filterKeyword=""},e.canSelectItem=function(t){return e.callback({item:t,selectedItems:e.selectedItems})},e.itemSelected=function(t){function l(c){c.forEach(function(c){t.selected&&!c.selected?e.selectedItems.push(c):!t.selected&&c.selected&&e.selectedItems.splice(e.selectedItems.indexOf(c),1),c.selected=t.selected,c.children&&c.children.length>0&&l(c.children)})}if(!(e.useCallback&&e.canSelectItem(t)===!1||e.selectOnlyLeafs&&t.children&&t.children.length>0)){if(e.multiSelect){t.selected=!0;var n=e.selectedItems.indexOf(t);i(t)?(t.selected=!1,e.selectedItems.splice(n,1)):e.selectedItems.push(t),t.children&&t.children.length>0&&l(t.children)}else{c();for(var r=0;r<e.selectedItems.length;r++)e.selectedItems[r].selected=!1;t.selected=!0,e.selectedItems=[],e.selectedItems.push(t)}this.refreshOutputModel()}},e.onSelectAll=function(e,t){function l(e){e.selected=!0,e.children.length>0&&e.children.forEach(function(e){l(e)})}e.forEach(function(e){l(e)}),this.refreshSelectedItems(),this.refreshOutputModel()},e.onClearAll=function(e,t){function l(e){e.selected=!1,e.children.length>0&&e.children.forEach(function(e){l(e)})}e.forEach(function(e){l(e)}),this.refreshSelectedItems(),this.refreshOutputModel()}}]),e.directive("multiselectSearchtree",function(){return{restrict:"E",templateUrl:"src/multiselect-searchtree.tpl.html",scope:{inputModel:"=",outputModel:"=?",multiSelect:"=?",selectOnlyLeafs:"=?",callback:"&",defaultLabel:"@",extraButtons:"=?"},link:function(e,t,l){function c(e,t){for(var l=n(e,[]),c=0,i=l.length;i>c;c++)if(-1!==l[c].name.toLowerCase().indexOf(t.toLowerCase()))return!1;return!0}function n(e,t){for(var l=0;l<e.children.length;l++)t.push(e.children[l]),n(e.children[l],t);return t}l.callback&&(e.useCallback=!0),e.extraButtons&&(e.clearSearchIconStyle={right:"240px"}),e.$watch("inputModel",function(t){t&&(e.refreshSelectedItems(),e.refreshOutputModel())}),e.$watch("filterKeyword",function(){void 0!==e.filterKeyword&&angular.forEach(e.inputModel,function(t){-1!==t.name.toLowerCase().indexOf(e.filterKeyword.toLowerCase())?t.isFiltered=!1:c(t,e.filterKeyword)?(t.isFiltered=!0,console.dir(angular.element(this))):t.isFiltered=!1})})},controller:"multiSelectTreeCtrl"}})}(),function(){"use strict";var e=angular.module("multiselect-searchtree");e.controller("treeItemCtrl",["$scope",function(e){e.item.isExpanded!==!1&&e.item.isExpanded!==!0&&(e.item.isExpanded=!0),e.showExpand=function(e){return e.children&&e.children.length>0},e.onExpandClicked=function(e,t){t.stopPropagation(),e.isExpanded=!e.isExpanded},e.clickSelectItem=function(t,l){l.stopPropagation(),e.itemSelected&&e.itemSelected({item:t})},e.subItemSelected=function(t,l){e.itemSelected&&e.itemSelected({item:t})},e.activeSubItem=function(t,l){e.onActiveItem&&e.onActiveItem({item:t})},e.onMouseOver=function(t,l){l.stopPropagation(),e.onActiveItem&&e.onActiveItem({item:t})},e.showCheckbox=function(){return e.multiSelect?e.selectOnlyLeafs?!1:e.useCallback?e.canSelectItem(e.item):void 0:!1}}]),e.directive("treeItem",["$compile",function(e){return{restrict:"E",templateUrl:"src/tree-item.tpl.html",scope:{item:"=",itemSelected:"&",onActiveItem:"&",multiSelect:"=?",selectOnlyLeafs:"=?",isActive:"=",useCallback:"=",canSelectItem:"="},controller:"treeItemCtrl",compile:function(t,l,c){angular.isFunction(c)&&(c={post:c});var n,i=t.contents().remove();return{pre:c&&c.pre?c.pre:null,post:function(t,l,r){n||(n=e(i)),n(t,function(e){l.append(e)}),c&&c.post&&c.post.apply(null,arguments)}}}}}])}();